<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>抽奖程序</title>
<link rel="stylesheet" type="text/css" href="images/main.css">
<script type="text/javascript" src="images/jquery.js"></script>
<script type="text/javascript" src="images/jQueryRotate.js"></script>
<script type="text/javascript" src="images/jquery_002.js"></script>
<script type="text/javascript" src="http://img.njdaily.cn/jui/plugin/jquery.cookie.js"></script>
<script type="text/javascript">
$(function(){
	 $("#disktop").click(function(){
	 	if(checkinfo()){
			lottery();
		}
	});
});
function checkinfo(){
	var phone = $.cookie('phone');
	var username  = $.cookie('username');
	if(phone=="" || phone.length!=11 || username==""){
		alert('请填写正确有效的信息');
		return false;
	}else{
		return true;
	}
}
function lottery(){
	if(!checkinfo()){
		return false;
	}
	var urlinfo = 'http://vote.njdaily.cn/2015/lsnj/zp/data.php?name=' +  $.cookie('username') + '&tel=' + $.cookie('phone') ;
	$.ajax({
		type: 'POST',
		url: urlinfo,
		dataType: 'json',
		cache: false,
		error: function(){
			alert('抽奖超时,请确保网络畅通');
			return false;
		},
		success:function(json){
			//$("#startbtn").unbind('click').css("cursor","default");
			var a = json.angle;
			var p = json.prize;
			var e = json.err;
			if(e!="" && e=="0"){alert('数据不完整')}
			else if((e!="" && e=="1")){alert('每个号码每天只能抽奖三次')}
			else if((e!="" && e=="2")){alert('服务器链接异常')}
			else{
				$("#startbtn").rotate({
					duration:3000,
					angle: 0,
					animateTo:1800 + a,
					easing: $.easing.easeOutSine,
					callback: function(){
						alert(p);
						/*
						var con = confirm('恭喜你，中得'+p+'\n还要再来一次吗？');
						if(con){
							lottery();
						}else{
							return false;
						}
						*/
					}
				});
			}
		}
	});
}
</script>
</head>

<body style="padding:0; margin:0">


<div id="main">
	<div class="demo">
		<!--div class="userinfo-form">
			<div class="form">
					<h2>填写个人信息</h2>
					<div class="items">
						<div class="item">
							<label for="username">姓名：</label>
							<input type="text" value="" id="username" name="username" class="input-text">
						</div>
						<div class="item">
							<label for="phone">手机：</label>
							<input type="text" value="" id="phone" name="phone" class="input-text">
						</div>
					</div>
					<div class="score-links f-cb">
						<a id="btn-submit" class="score-link f-fl" href="javascript:;">提 交</a>
						<a id="btn-back" class="score-link f-fr" href="javascript:;">返 回</a>
					</div>
				</div>
		</div-->
			
		<div id="disk"></div>
		<div id="disktop"></div>
		<div id="start"><img style="cursor: default; transform: rotate(81deg);" src="images/start.png" id="startbtn"></div>
	</div>
</div>


</body>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F7f32aed534f2da344768184078540b91' type='text/javascript'%3E%3C/script%3E"));
</script>
</html>